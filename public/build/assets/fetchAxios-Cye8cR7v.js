import m from"./axiosClient-8LtfCK6A.js";import{c as h}from"./modalHandler-Bg5eHBCv.js";import{a as v}from"./badgeUpdater-D1PKXa5-.js";function p(e,a){let t=e||{},s=!1;document.querySelectorAll("[data-name], input, select, textarea").forEach(r=>{r.classList.remove("is-invalid","is-valid");let n=r.closest(".ts-wrapper");n&&n.classList.remove("is-invalid","is-valid")}),document.querySelectorAll(".invalid-feedback").forEach(r=>{r.textContent="",r.style.display="none"}),Object.keys(t).forEach(r=>{var c,l,d,u;let n=r.replace(/\.\d+$/,""),o=document.querySelector(`[data-name="${n}"], [name="${n}"]`),i=((c=o==null?void 0:o.closest(".form-group"))==null?void 0:c.querySelector(".invalid-feedback"))||((l=o==null?void 0:o.closest(".input-group"))==null?void 0:l.querySelector(".invalid-feedback"))||document.querySelector(`.${n}_error`);if(o){o.classList.add("is-invalid");let f=o.closest(".ts-wrapper")||((d=document.querySelector(`#${o.id}_tomselect`))==null?void 0:d.closest(".ts-wrapper"))||((u=o.parentElement)==null?void 0:u.querySelector(".ts-wrapper"));f&&f.classList.add("is-invalid")}i&&(i.textContent=t[r][0],i.style.display="block"),s||(showToast(t[r][0],"error"),s=!0)}),typeof a=="function"&&a()}function g(e,a){if(e.response){const{status:t,data:s}=e.response;if(t===422){let r;if(s.errors)r=s.errors;else if(s.message&&typeof s.message=="object")r=s.message;else{showToast(s.message||"Terjadi kesalahan validasi","error");return}p(r,a)}else s&&s.message?showToast(s.message,"error"):showToast("Terjadi kesalahan, silakan coba lagi.","error")}else console.error("Network error:",e),showToast("Terjadi kesalahan jaringan. Coba lagi.","error")}function w(){m.get("/admin/api/menus/sidebar").then(e=>{if(e.data.success&&e.data.html){const a=document.querySelector("nav ul#navigation");if(a){const t=[];document.querySelectorAll(".nav-item.has-treeview.menu-open").forEach(o=>{const i=o.querySelector(".nav-link");i&&t.push(i.textContent.trim())});const n=new DOMParser().parseFromString(e.data.html,"text/html").querySelector("ul#navigation");n&&a&&a.tagName==="UL"&&(a.innerHTML=n.innerHTML),setTimeout(()=>{if(a){y();const i=window.location.pathname;document.querySelectorAll(".nav-link").forEach(c=>{const l=c.getAttribute("href");if(l){const d=l.replace(window.location.origin,"");if(i===d||i.startsWith(d.replace(/\/$/,"")+"/")){c.classList.add("active");const u=c.closest(".nav-item.has-treeview");u&&u.classList.add("menu-open")}}})}},200)}}}).catch(e=>{})}function y(){document.querySelectorAll(".nav-item.has-treeview > .nav-link").forEach(t=>{t.replaceWith(t.cloneNode(!0))}),document.querySelectorAll(".nav-item.has-treeview > .nav-link").forEach(t=>{t.addEventListener("click",T)});const a=document.getElementById("navigation");a&&(a.setAttribute("data-lte-toggle","treeview"),a.setAttribute("data-accordion","false"))}function T(e){e.preventDefault(),e.stopPropagation();const a=this.closest(".nav-item");a.querySelector(".nav-treeview")&&a.classList.toggle("menu-open")}function S(){var e;return(e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.content}function k(e,a){const{data:t}=e;if(t.status==="error"){showToast(t.message||"Terjadi kesalahan","error");return}t.message&&showToast(t.message,"success"),t.refresh_sidebar&&setTimeout(()=>{w()},500),h(),typeof a=="function"&&a(t)}async function b(e){if(!e.url){showToast("‚ùå URL tidak boleh kosong!","error");return}let a="GET";e.method&&typeof e.method=="string"&&(a=e.method.toUpperCase());try{const t=await m({method:a,url:e.url,data:e.data||{},headers:{"X-CSRF-TOKEN":S(),Accept:"application/json"}});k(t,e.callback)}catch(t){g(t,e.callback)}}function L(e,a,t){b({...e,actionType:a,callback:function(...r){t&&typeof t=="function"&&t(...r),e.url&&v(e.url)}})}export{L as f};
