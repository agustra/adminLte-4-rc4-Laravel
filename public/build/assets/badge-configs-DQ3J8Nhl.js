const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/formatDate-B2IUMST6.js","assets/axiosClient-DXQnQ5LA.js"])))=>i.map(i=>d[i]);
import{_ as g}from"./preload-helper-BfFHrpNk.js";import{ModernTable as B}from"https://cdn.jsdelivr.net/npm/modern-table-js@1.0.6/core/ModernTable.js";import{D as S,f as _,c as D,a as T,b as v,g as x,d as E}from"./formatDate-B2IUMST6.js";import{s as d,f as w,h as A}from"./fetchAxios-DNDRkkvY.js";import{A as M}from"./ActionButton-4FF2Dtnd.js";import{f as F,D as I}from"./DateRangePicker-pIMxf9xW.js";/* empty css                              */import"./axiosClient-DXQnQ5LA.js";import"./_commonjsHelpers-CqkleIqs.js";const $=x(),f={month:null,year:null,start_date:null,end_date:null,date:$},o={tableId:"#table-badge-configs",urlWeb:"/admin/badge-configs/",urlApi:"/api/badge-configs",deleteMultipleUrl:"/api/badge-configs/multiple/delete",tableName:"badge-configs",exportColumns:["menu_url","model_class"],createButtonText:"Add Badge Config",itemName:"badge-configs",pageLength:10,lengthMenu:[5,10,25,50],defaultOrder:[[0,"desc"]],dateRangeButtonText:"Filter Tanggal",apiErrorPrefix:"Badge Configs API Error:",dataLoadedMessage:"✅ Data loaded:",createButtonId:"btnTambah",bulkDeleteButtonId:"delete-selected-btn",dateRangeSelector:"#idFilterDateRange",dateRangeTextSelector:"#idFilterDateRange .date-range-text",actionButtonSelector:"#btnAction",formSelector:".FormAction",deleteButtonClass:".btn-delete",createButtonClass:".btnTambah",updateButtonClass:".buttonUpdate",showButtonClass:".buttonShow"};let u=!1,i={...f};const L=()=>u?Object.fromEntries(Object.entries(i).filter(([t,e])=>e!==null)):{},h=t=>{u=!0,i={...i,...t,date:null}},b=()=>{u=!1,i={...f}},R=T({buttonId:o.bulkDeleteButtonId,countSelector:".selected-count",onSelectionChange:(t,{count:e,hasSelection:a})=>{console.log(`ℹ️ Selection changed: ${e} ${o.itemName} selected`)}}),k=E({deleteUrl:o.deleteMultipleUrl,itemName:o.itemName,onSuccess:(t,e)=>{console.log("✅ Bulk delete success:",t.length,`${o.itemName} deleted`),document.dispatchEvent(new CustomEvent("badgeConfigChanged"))},onError:t=>{console.error("❌ Bulk delete failed:",t)}});function y(){return _(new Date),{...D({url:o.urlApi,beforeSend:e=>Object.assign(e,L()),onSuccess:e=>{var n;const a=(n=e==null?void 0:e.meta)==null?void 0:n.permissions;a&&A(a)},onError:(e,a,n)=>{console.error(o.apiErrorPrefix,{error:e,status:a,message:n})}}),columns:[{data:"DT_RowIndex",title:"No",orderable:!1,searchable:!1},{data:"menu_url",title:"Menu URL",orderable:!0},{data:"model_class",title:"Model Class",orderable:!0},{data:"date_field",title:"Date Field",orderable:!0},{data:"is_active",title:"Status",orderable:!0,render:e=>{const a=e==1||e===!0;return`<span class="badge ${a?"bg-success":"bg-danger"}">${a?"Active":"Inactive"}</span>`}},{data:"description",title:"Description",orderable:!0},{data:"actions",title:"Action",className:"text-center",orderable:!1,searchable:!1,render:(e,a,n)=>M(n)}],buttons:v({tableName:o.tableName,exportColumns:o.exportColumns,bulkDeleteHandler:k,bulkDeleteButtonId:o.bulkDeleteButtonId,includeCreateButton:!0,createButtonId:o.createButtonId,createButtonText:o.createButtonText,createHandler:()=>{d(`${o.urlWeb}create`,"create")}}),pageLength:o.pageLength,lengthMenu:o.lengthMenu,order:o.defaultOrder,ordering:!0,searching:!0,columnSearch:!0,paging:!0,select:!0,responsive:!0,theme:"auto",onSelectionChange:R,onError:e=>console.error("❌ Table error:",e)}}function N(t,e,a){t||e?h({month:t||null,year:e||null}):b(),a.reload()}function P(t,e){if(t){h({start_date:t.start,end_date:t.end});const a=document.querySelector(o.dateRangeTextSelector);a&&(a.textContent=t.formatted)}else b();e.reload()}function p(){const t=y(),e=new B(o.tableId,{...t,initComplete:(a,n)=>{console.log(o.dataLoadedMessage,a.length,"records")}});return F((a,n)=>{N(a,n,e)}),new I(o.dateRangeSelector,{buttonText:o.dateRangeButtonText,onDateSelect:a=>{P(a,e)}}),e}function C(t){S({buttonSelector:o.deleteButtonClass,deleteUrl:o.urlApi+"/",tableSelector:o.tableId,onDeleteSuccess:()=>{t.reload(),t.clearSelection(),document.dispatchEvent(new CustomEvent("badgeConfigChanged"))}}),document.body.addEventListener("click",e=>{const a=e.target.closest(o.updateButtonClass),n=e.target.closest(o.showButtonClass),l=e.target.matches(o.actionButtonSelector);if(e.target.closest(o.createButtonClass))e.preventDefault(),d(`${o.urlWeb}create`,"create");else if(a){e.preventDefault();const r=`${o.urlWeb}${a.dataset.id}/edit`;d(r,"edit")}else if(n){e.preventDefault();const r=`${o.urlWeb}${n.dataset.id}`;d(r,"show")}else if(l){e.preventDefault();const r=document.querySelector(o.formSelector);r&&w({url:r.action,method:r.method,data:new FormData(r)},"simpan",()=>{t.reload(),document.dispatchEvent(new CustomEvent("badgeConfigChanged")),setTimeout(()=>{g(()=>import("./formatDate-B2IUMST6.js").then(c=>c.h),__vite__mapDeps([0,1])).then(c=>{c.autoUpdateBadgeForUrl()})},1e3)})}})}function O(){return function(t,e){if(!t||t.trim().length<2){e();return}const a=t.trim();if(!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(a)){showToast("Field name harus format valid (contoh: created_at, registration_date)","error"),e();return}e({value:a,text:a}),showToast(`Field '${a}' berhasil ditambahkan`,"success")}}function U(){return function(t,e){if(!t||t.trim().length<5){e();return}const a=t.trim();if(!/^App\\Models\\[A-Za-z][A-Za-z0-9]*$/.test(a)){showToast("Model class harus format valid (contoh: App\\Models\\YourModel)","error"),e();return}e({value:a,text:a}),showToast(`Model '${a}' berhasil ditambahkan`,"success")}}function m(){return{option:function(t,e){return`<div>${e(t.text)}</div>`},item:function(t,e){return`<div>${e(t.text)}</div>`}}}document.addEventListener("shown.bs.modal",async t=>{const e=t.target;(async()=>{try{const a=await g(()=>import("./tom-select.complete-Dc6LGOTC.js"),[]),n=a.default||a.TomSelect||a,l=e.querySelector("#date_fields");l&&!l.tomselect&&new n(l,{create:!0,maxItems:null,placeholder:"Pilih atau ketik field tanggal...",onCreate:O(),render:m()});const s=e.querySelector("#model_class");s&&!s.tomselect&&new n(s,{create:!0,placeholder:"Pilih atau ketik model class...",onCreate:U(),render:m()})}catch(a){console.error("Error loading select:",a)}})()});document.addEventListener("DOMContentLoaded",()=>{const t=p();C(t)});function J(){if(document.readyState!=="loading"){const t=p();C(t)}}export{J as default};
